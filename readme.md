# 哥布林部落

## 代码结构

```txt
src/
├── core/
│   ├── entities.js      - 实体基类与实体类型
│   ├── registries.js    - 注册表系统
│   └── factories.js     - 工厂类
├── systems/
│   ├── event-bus.js     - 事件总线
│   ├── formula.js       - 公式引擎
│   ├── time.js          - 时间系统
│   ├── resource.js      - 资源系统
│   ├── task.js          - 任务系统
│   ├── intel.js         - 情报系统
│   ├── combat.js        - 战斗系统
│   ├── breeding.js      - 繁殖系统
│   ├── spell.js         - 法术系统
│   └── market.js        - 黑市系统
├── config/
│   ├── attributes.js    - 属性配置
│   ├── tasks.js         - 任务配置
│   ├── spells.js        - 法术配置
│   ├── items.js         - 商品配置
│   └── formulas.js      - 公式配置
├── game/
│   ├── state.js         - 游戏状态
│   ├── controller.js    - 游戏控制器
│   └── plugin.js        - 插件系统
└── index.js             - 入口文件
```

---

## 设定

### 任务枚举

说明: 任务发布后，执行者和目标会被占用，发布任务时，执行者和目标不可选择被占用的角色。已经发布的任务在一回合（一周）结束前可以取消/修改，回合结束依次结算已经发布的任务。同一个任务可多次发布，但是依然不可选择被占用的角色

名称：调教
执行者：冠军
行动力消耗：1
前置条件：无
目标：母畜
描述：冠军对母畜进行调教，提升其臣服度
效果：母畜.臣服度 += fn(冠军.智力)
fn(x){return x/10 + 5}

名称：劝慰
执行者：母畜a
行动力消耗：1
前置条件：母畜a.臣服度>=50
目标：母畜b
描述：已归心的母畜劝慰新来者，同种族有加成
效果：母畜b.臣服度 += fn(母畜a.种族,母畜b.种族)
fn(x,y){return x==y ? 1.3 : 1}

名称：侦察
执行者：冠军
行动力消耗：1
前置条件：无
目标：地点
描述：派遣冠侦察
效果：侦察成功率：fn(冠军.敏捷)，如果成功：地点.侦察进度 += gn(冠军.敏捷), 锁定母畜=hn(冠军.敏捷, 地点.侦察进度)
fn(x){return (x+50)/100}
gn(x){return (x+50)/10}
hn(x,y){return {必定锁定数量:(x+50)*(y+25)//7500, 额外锁定概率:((x+50)*(y+25)%7500)/7500}}

名称：潜入侦察
执行者：母畜
行动力消耗：1
前置条件：母畜.臣服度>=75
目标：地点
描述：派遣忠诚母畜潜入目标进行侦察
效果：侦察成功率：fn()，如果成功：地点.侦察进度 += gn(母畜.淫乱度), 锁定母畜=hn(母畜.淫乱度,地点.侦察进度)
fn(x){return (125-x)/100}
gn(x){return (125-x)/10}
hn(x,y){return {必定锁定数量:(125-x)*(y+25)//7500, 额外锁定概率:((125-x)*(y+25)%7500)/7500}}

名称：潜入劝诱
执行者：母畜
行动力消耗：1
前置条件：母畜.臣服度>=90
目标：地点.已锁定母畜
描述：派遣母畜劝诱目标地点的女性加入部落
效果：成功率 = fn(母畜.淫乱度, 母畜.总生育力, 地点.已锁定母畜.总生育力)
fn(x,y,z){return (y-z+50)*(125-x)/1000}

名称：生育冠军
执行者：母畜
行动力消耗：母畜.臣服度>25 ? 1 : 2
前置条件：母畜.剩余生育力>=100
目标：无
描述：母畜生育一名冠军
效果：母畜.剩余生育力-=100, 母畜.淫乱度+=6

名称：生育喽啰
执行者：母畜
行动力消耗：母畜.臣服度>25 ? 0 : 1
前置条件：母畜.剩余生育力>=10
目标：无
描述：母畜生育10名喽啰
效果：生育数量=min(10,母畜.剩余生育力//10), 母畜.剩余生育力-=生育数量*10, 母畜.淫乱度+=6

名称：提振士气
执行者：母畜
行动力消耗：1
前置条件：母畜.臣服度>75
目标：无
描述：母畜供喽啰使用以提振士气
效果：士气+=fn(母畜.总生育力), 母畜.淫乱度+=10
fn(x){return (x+50)/25}

名称：泌乳
执行者：母畜
行动力消耗：0
前置条件：母畜.淫乱度>25
目标：无
描述：产出母乳
效果：催淫母乳数量 += fn(母畜.淫乱度), 母畜.淫乱度+=3
fn(x){return (x+20)//10}

名称：献祭
执行者：母畜
行动力消耗：0
前置条件：母畜.淫乱度=100
目标：无
描述：献祭母畜换取魔力
效果：领主.魔力 += (母畜.总生育力+50)//50

### 黑市商品枚举

名称：破旧兵刃
价格: 1催淫母乳数量,
目标: 喽啰池
每周限购: Infinity,
描述: '勉强能用的武器和护甲，聊胜于无'
效果: 喽啰池.武装升级(数量:10, 目标等级:'低级武装', 优先等级列表 : ['未武装','低级武装','中级武装','高级武装', '精英武装'])

名称：标准铁剑
价格: 1催淫母乳数量,
目标: 喽啰池
每周限购: Infinity,
描述: '正规军队的标准装备'
效果: 喽啰池.武装升级(数量:4, 目标等级:'中级武装', 优先等级列表 : ['未武装','低级武装','中级武装','高级武装', '精英武装'])

名称：走私的骑士武装
价格: 1催淫母乳数量,
目标: 喽啰池
每周限购: Infinity,
描述: '通过特殊渠道走私的骑士装备'
效果: 喽啰池.武装升级(数量:1, 目标等级:'高级武装', 优先等级列表 : ['未武装','低级武装','中级武装','高级武装', '精英武装'])

名称：附魔战争装备
价格: 4催淫母乳数量,
目标: 喽啰池
每周限购: Infinity,
描述: '带有魔法增强的顶级装备'
效果: 喽啰池.武装升级(数量:1, 目标等级:'精英武装', 优先等级列表 : ['未武装','低级武装','中级武装','高级武装', '精英武装'])

```js
低级武装: {
  战斗力: 110,
  描述: '破旧兵刃',
}
中级武装: {
  战斗力: 120,
  描述: '标准铁剑',
}
高级武装: {
  战斗力: 160,
  描述: '骑士武装',
}
精英武装: {
  战斗力: 300,
  描述: '附魔装备',
}
```

名称：祝福水晶
价格: 50催淫母乳数量,
目标: 母畜
每周限购: 1,
描述: '神殿中流出的神圣水晶，可提高生育力'
效果: 母畜.总生育力 += (2000 / (母畜.淫乱度 + 20)), 母畜.剩余生育力 += (2000 / (母畜.淫乱度 + 20))

名称：净化水晶
价格: 25催淫母乳数量,
目标: 母畜
每周限购: 5,
描述: '可以净化淫乱的神圣之物'
效果: 母畜.淫乱度 -= 10

名称：魔力水晶
价格: 15催淫母乳数量,
目标: 领主
每周限购: 1,
描述: '蕴含黑暗魔力的水晶，可为领主补充魔力'
效果: 领主.魔力 += 3

名称：奴隶
价格: ??,
目标: 无
描述: '黑市上流通的奴隶'
效果: 获得母畜
说明: 每周从“黑市奴隶池”，根据“黑市奴隶刷新规则”随机刷新0-3个奴隶
黑市奴隶池: 预配置的母畜列表
黑市奴隶刷新规则: 额外配置

### 法术枚举

说明: 一回合只能使用一个法术

名称：魔眼侦察
价格: 1魔力,
目标: 地点
描述: '立刻提高目标情报进度'
效果: 地点.侦察进度 += 20

名称：意志粉碎
价格: 1魔力,
目标: 母畜
描述: '目标母畜臣服度增加'
效果: 母畜.臣服度 += 10

名称：孕力回复
价格: 10魔力,
目标: 母畜
描述: '目标母畜剩余生育力增加'
效果: 母畜.剩余生育力 += 50

名称：士气鼓舞
价格: 5魔力,
目标: 无
描述: '立刻提升军队士气'
效果: 士气 += 30
